<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Proxy Ảnh - Phương án 1</title>
  <style>
    .image-container {
      margin: 20px 0;
      position: relative;
    }
    .hidden-proxy {
      position: absolute;
      width: 0;
      height: 0;
      overflow: hidden;
    }
    .proxy-image {
      max-width: 100%;
      height: auto;
      border: 1px solid #ddd;
      transition: opacity 0.3s;
    }
    .loading {
      background: #f5f5f5;
      min-height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #888;
    }
  </style>
</head>
<body>
  <h1>Proxy Ảnh - Phương án 1</h1>
  <p>Sử dụng Object/Embed để ẩn link jsDelivr</p>

  <div class="image-container">
    <div class="hidden-proxy">
      <object data="https://cdn.jsdelivr.net/gh/azcloud68/my-cdn-test@main/images/test1.jpg" 
              type="image/jpeg"
              aria-hidden="true"></object>
    </div>
    <img class="proxy-image" 
         src="/gh/azcloud68/my-cdn-test@main/images/test1.jpg" 
         alt="Ảnh test 1"
         onerror="fallbackImage(this)"
         loading="lazy">
  </div>

  <script>
    function fallbackImage(img) {
      // Lấy đường dẫn jsDelivr từ thẻ object
      const object = img.parentElement.querySelector('object');
      if (object) {
        img.src = object.data;
        img.onerror = null; // Remove error handler after fallback
      }
    }

    // Đăng ký Service Worker nếu trình duyệt hỗ trợ
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch(console.error);
    }
  </script>
</body>
</html>
